<!DOCTYPE html>
<html>
<head>
  <title>Spanish Tutor Bot</title>
  <style>
    #chatbox { height: 300px; border: 1px solid #ccc; overflow-y: scroll; padding: 10px; }
    #userInput { width: 70%; padding: 8px; }
  </style>
</head>
<body>
  <h1>Spanish Tutor</h1>
  <select id="moduleSelect">
    <option value="1">Lesson 1</option>
    <option value="2">Lesson 2</option>
    <option value="3">Lesson 3</option>
  </select>
  <div id="chatbox"></div>
  <input type="text" id="userInput" placeholder="Ask something..." />
  <button onclick="sendMessage()">Send</button>

  <script>
    // Set default module from URL
    const urlParams = new URLSearchParams(window.location.search);
    document.getElementById('moduleSelect').value = urlParams.get('module') || '1';

    function getSystemMessage(module) {
      const rules = {
        '1': "You are a Module 1 Spanish tutor. Use 80% English, 20% Spanish. Only use: hola, gracias, Â¿cÃ³mo estÃ¡s?, soy, tengo.",
        '2': "You are a Module 2 tutor. Use 50% Spanish. Add: quiero, voy a, necesito, el/la, los/las.",
        '3': "You are a Module 3 tutor. Use 70% Spanish. Add past tense: ayer fui, tomÃ©, hablÃ©."
      };
      return rules[module] || rules['1'];
    }

    async function sendMessage() {
      const module = document.getElementById('moduleSelect').value;
      const userInput = document.getElementById('userInput');
      const chatbox = document.getElementById('chatbox');
      const message = userInput.value;

      chatbox.innerHTML += `<p><strong>You:</strong> ${message}</p>`;
      userInput.value = '';

      const response = await fetch('https://api.openai.com/v1/chat/completions', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': 'Bearer YOUR_API_KEY'  // ðŸ”´ Replace or use a proxy!
        },
        body: JSON.stringify({
          model: "gpt-3.5-turbo",
          messages: [
            { role: "system", content: getSystemMessage(module) },
            { role: "user", content: message }
          ]
        })
      });

      const data = await response.json();
      chatbox.innerHTML += `<p><strong>Bot:</strong> ${data.choices[0].message.content}</p>`;
    }
  </script>
</body>
</html>

<!-- Canvas: <iframe src="https://username.github.io/repo?module=2" width="600" height="400"></iframe> -->
